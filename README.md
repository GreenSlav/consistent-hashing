# consistent-hashing

Consistent Hashing (CH) — это метод хеширования, используемый для эффективного распределения нагрузки в распределённых системах, минимизируя перераспределение данных при изменении количества узлов.

### Зачем нужен?
В системах, таких как кеширование (например, в распределенных кешах типа Memcached) или балансировка нагрузки, возникает необходимость равномерного распределения данных между узлами. Однако при традиционном хешировании (mod N) любое изменение числа узлов приводит к резкому перераспределению ключей. Consistent Hashing решает эту проблему, минимизируя изменения при добавлении или удалении узлов.

Основные задачи CH:
- Балансировка нагрузки между узлами
- Минимизация перестановки данных при изменении топологии
- Повышение отказоустойчивости распределённых систем
- Оптимизация кеширования и маршрутизации запросов

### Какие проблемы решает?
В отличие от традиционного хеширования, CH решает следующие проблемы:
- Переход ключей: при изменении числа узлов только небольшая часть ключей изменяет свое местоположение.
- Динамическое масштабирование: добавление или удаление серверов не требует полного перераспределения данных.
- Гибкость и отказоустойчивость: система устойчива к сбоям отдельных узлов и легко адаптируется к изменяющейся среде.

### Как работает?
1. Все узлы (серверы) и ключи отображаются на кольцо хеширования.
2. Каждый сервер получает несколько позиций на кольце (Virtual Nodes) для равномерного распределения нагрузки.
3. Ключи направляются к ближайшему по часовой стрелке узлу.
4. При добавлении или удалении узлов перераспределяются только ближайшие к ним ключи.

### Архитектурные подходы в реализации
#### 1. Простое кольцевое хеширование
Каждый узел получает одну точку на хеш-кольце, что может привести к неравномерному распределению нагрузки.

#### 2. Virtual Nodes (Виртуальные узлы)
Для равномерного распределения нагрузки каждый узел получает несколько точек на хеш-кольце.

#### 3. Replication (Репликация)
Для повышения отказоустойчивости ключи хранятся на нескольких соседних узлах.

### Где применяется?
- Распределенные кеши (Memcached, Redis Cluster)
- Балансировка нагрузки (NGINX, HAProxy)
- Распределенные базы данных (Cassandra, DynamoDB)
- P2P-сети (BitTorrent, Kademlia)
- CDN (Content Delivery Networks)

### Популярные реализации
- Consistent Hashing в Redis Cluster (sharding данных)
- Cassandra (динамическое распределение данных между нодами)
- Amazon DynamoDB (основан на DHT - Distributed Hash Table)
- Netflix Eureka (использует CH для балансировки)
- NGINX и HAProxy (маршрутизация запросов)

### Заключение
Consistent Hashing является ключевым методом в распределённых системах, обеспечивая балансировку нагрузки, отказоустойчивость и минимальные изменения при масштабировании. Он широко применяется в кешировании, балансировке нагрузки и распределённых базах данных, обеспечивая стабильность и производительность системы.